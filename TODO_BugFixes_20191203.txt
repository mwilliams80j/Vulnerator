Because of enhancements to the SQL query string for tabulating open CAT I/II/III/IV counts, some hard-coded offsets *STILL NEED TO BE FIXED* (sigh, Alex, you really were
lazy in that code!).  Below is the original string with notation where you will see the "magic number" insertion points for FPR and XCCDF mods (at 729 and 893).
You can see with the second much longer string that the correct insertion points are WAY SHIFTED RIGHT now.  But I want to fix the code to remove the hard-coded
offsets and instead use a regex find/replace to do the inserts...

But that is work for another day...

SELECT AssetIdToReport, HostName, IpAddress, GroupName, SUM(CASE WHEN (RawRisk = 'I' OR (Impact = 'Critical' AND RawRisk IS NULL) OR (Impact = 'High' AND RawRisk IS NULL)) AND Status = 'Ongoing' THEN 1 ELSE 0 END) AS CatI, SUM(CASE WHEN (RawRisk = 'II' OR (Impact = 'Medium' AND RawRisk IS NULL)) AND Status = 'Ongoing' THEN 1 ELSE 0 END) AS CatII, SUM(CASE WHEN (RawRisk = 'III' OR (Impact = 'Low' AND RawRisk IS NULL)) AND Status = 'Ongoing' THEN 1 ELSE 0 END) AS CatIII, SUM(CASE WHEN (RawRisk = 'IV' OR (Impact = 'Informational' AND RawRisk IS NULL)) AND Status = 'Ongoing' THEN 1 ELSE 0 END) AS CatIV, COUNT(CASE WHEN Status = 'Ongoing' THEN 1 END) AS Total, OperatingSystem, IsCredentialed, Found21745, Found26917, FileName FROM Assets NATURAL JOIN UniqueFinding NATURAL JOIN Vulnerability NATURAL JOIN Groups NATURAL JOIN FileNames NATURAL JOIN FindingTypes NATURAL JOIN FindingStatuses WHERE FindingType = @FindingType GROUP BY AssetIdToReport, FileName;
0.........1.........2.........3.........4.........5.........6.........7.........8.........9.........0.........1.........2.........3.........4.........5.........6.........7.........8.........9.........0.........1.........2.........3.........4.........5.........6.........7.........8.........9.........0.........1.........2.........3.........4.........5.........6.........7.........8.........9.........0.........1.........2.........3.........4.........5.........6.........7.........8.........9.........0.........1.........2.........3.........4.........5.........6.........7.........8.........9.........0.........1.........2.........3.........4.........5.........6.........7.........8.........9.........0.........1.........2........93.........4.........5.........6.........7.........8.........9.........0.........1.........2.........3.........4.........5.........6.........7.........8.........9..3......0.........1.........2.........3.........4.........5.........6.........7.........8.........9.........0
....................................................................................................0...................................................................................................0...................................................................................................0...................................................................................................0...................................................................................................0...................................................................................................0...................................................................................................0............................2......................................................................0............................................................................................9......0...................................................................................................0
....................................................................................................1...................................................................................................2...................................................................................................3...................................................................................................4...................................................................................................5...................................................................................................6...................................................................................................7............................7......................................................................8............................................................................................8......9...................................................................................................0

SELECT AssetIdToReport, HostName, IpAddress, GroupName, SUM(CASE WHEN (SeverityOverride = 'I' OR (RawRisk = 'I' AND SeverityOverride IS NULL) OR (Impact = 'Critical' AND RawRisk IS NULL AND SeverityOverride IS NULL) OR (Impact = 'High' AND RawRisk IS NULL AND SeverityOverride IS NULL)) AND Status = 'Ongoing' THEN 1 ELSE 0 END) AS CatI, SUM(CASE WHEN (SeverityOverride = 'II' OR (RawRisk = 'II' AND SeverityOverride IS NULL) OR (Impact = 'Medium' AND RawRisk IS NULL AND SeverityOverride IS NULL)) AND Status = 'Ongoing' THEN 1 ELSE 0 END) AS CatII, SUM(CASE WHEN (SeverityOverride = 'III' OR (RawRisk = 'III' AND SeverityOverride IS NULL) OR (Impact = 'Low' AND RawRisk IS NULL AND SeverityOverride IS NULL)) AND Status = 'Ongoing' THEN 1 ELSE 0 END) AS CatIII, SUM(CASE WHEN (SeverityOverride = 'IV' OR (RawRisk = 'IV' AND SeverityOverride IS NULL) OR (Impact = 'Informational' AND RawRisk IS NULL AND SeverityOverride IS NULL)) AND Status = 'Ongoing' THEN 1 ELSE 0 END) AS CatIV, COUNT(CASE WHEN Status = 'Ongoing' THEN 1 END) AS Total, OperatingSystem, IsCredentialed, Found21745, Found26917, FileName FROM Assets NATURAL JOIN UniqueFinding NATURAL JOIN Vulnerability NATURAL JOIN Groups NATURAL JOIN FileNames NATURAL JOIN FindingTypes NATURAL JOIN FindingStatuses WHERE FindingType = @FindingType GROUP BY AssetIdToReport, FileName;
0.........1.........2.........3.........4.........5.........6.........7.........8.........9.........0.........1.........2.........3.........4.........5.........6.........7.........8.........9.........0.........1.........2.........3.........4.........5.........6.........7.........8.........9.........0.........1.........2.........3.........4.........5.........6.........7.........8.........9.........0.........1.........2.........3.........4.........5.........6.........7.........8.........9.........0.........1.........2.........3.........4.........5.........6.........7.........8.........9.........0.........1.........2.........3.........4.........5.........6.........7.........8.........9.........0.........1.........2........93.........4.........5.........6.........7.........8.........9.........0.........1.........2.........3.........4.........5.........6.........7.........8.........9..3......0.........1.........2.........3.........4.........5.........6.........7.........8.........9.........0
....................................................................................................0...................................................................................................0...................................................................................................0...................................................................................................0...................................................................................................0...................................................................................................0...................................................................................................0............................2......................................................................0............................................................................................9......0...................................................................................................0
....................................................................................................1...................................................................................................2...................................................................................................3...................................................................................................4...................................................................................................5...................................................................................................6...................................................................................................7............................7......................................................................8............................................................................................8......9...................................................................................................0
